<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Flame Division Academy — Digital Certificate</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="certificate.css" />
  <style>
    /* Little debug tag so we KNOW JS executed */
    .cert-debug {
      position: fixed;
      bottom: 8px;
      left: 12px;
      font-size: 10px;
      opacity: 0.6;
      color: #f5b544;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
                   "Segoe UI", sans-serif;
      pointer-events: none;
      z-index: 9999;
    }
  </style>
</head>
<body>
  <div class="cert-wrapper">
    <div class="cert-page">
      <header class="cert-header">
        <div class="cert-title-block">
          <h1>FLAME DIVISION ACADEMY</h1>
          <p class="cert-subtitle">Master Systems Architect Track</p>
        </div>

        <div class="cert-seal">
          <img
            src="../assets/fda-master-systems-emblem.png"
            alt="Flame Division Academy — Master Systems Architect Seal"
          />
        </div>
      </header>

      <main class="cert-body">
        <p class="cert-line">This certifies that</p>

        <!-- THIS is what JS will overwrite -->
        <h2 id="cert-name" class="cert-name">
          Student Name
        </h2>

        <p class="cert-line">has successfully completed</p>

        <!-- JS overwrites this too -->
        <p id="cert-course" class="cert-course">
          Flame Division Academy — Master Systems Architect Track
        </p>

        <p class="cert-line small">
          and has demonstrated verifiable competence in:
        </p>

        <p class="cert-pillars">
          Structure · Wiring · Function · Responsibility · Clarity
        </p>

        <p class="cert-law">
          “Language without structure is noise.
          Structure without ethics is danger.”
        </p>
      </main>

      <footer class="cert-footer">
        <div class="cert-meta">
          <div>
            <span class="meta-label">Date Issued:</span>
            <span id="cert-date" class="meta-value">YYYY-MM-DD</span>
          </div>
          <div>
            <span class="meta-label">Certificate ID:</span>
            <span id="cert-id" class="meta-value">FDA-0000-0000</span>
          </div>
        </div>

        <div class="cert-signatures">
          <div class="sig-block">
            <div class="sig-line"></div>
            <div class="sig-label">Commander Flame, CAIO</div>
          </div>
          <div class="sig-block">
            <div class="sig-line"></div>
            <div class="sig-label">Flame Division Academy Tutor AI</div>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <!-- Visible JS status -->
  <div id="cert-debug" class="cert-debug"></div>

  <!-- INLINE SCRIPT — no external certificate.js needed -->
  <script>
    (function () {
      // Safe param reader (NO double decoding)
      function getParam(key, fallback) {
        var params = new URLSearchParams(window.location.search || "");
        var value = params.get(key);
        return (value === null || value === "") ? fallback : value;
      }

      function slugifyId(text) {
        return text
          .trim()
          .replace(/\s+/g, "-")
          .replace(/[^a-zA-Z0-9\-]/g, "")
          .toUpperCase();
      }

      window.addEventListener("DOMContentLoaded", function () {
        var nameEl = document.getElementById("cert-name");
        var courseEl = document.getElementById("cert-course");
        var dateEl = document.getElementById("cert-date");
        var idEl = document.getElementById("cert-id");
        var debugEl = document.getElementById("cert-debug");

        if (!nameEl || !courseEl || !dateEl || !idEl) {
          if (debugEl) debugEl.textContent = "⚠️ Missing cert elements";
          return;
        }

        // NAME
        var studentName = getParam("name", "Student Name");
        nameEl.textContent = studentName;

        // COURSE
        var defaultCourse =
          "Flame Division Academy — Master Systems Architect Track";
        var courseName = getParam("course", defaultCourse);
        courseEl.textContent = courseName;

        // DATE
        var today = new Date();
        var isoToday = today.toISOString().slice(0, 10); // YYYY-MM-DD
        var dateValue = getParam("date", isoToday);
        dateEl.textContent = dateValue;

        // CERTIFICATE ID
        var idParam = getParam("id", "");
        if (idParam) {
          idEl.textContent = idParam.toUpperCase();
        } else {
          var base = studentName + "-" + dateValue;
          idEl.textContent = "FDA-" + slugifyId(base);
        }

        if (debugEl) {
          debugEl.textContent =
            "JS ACTIVE · " +
            decodeURIComponent(window.location.search || "").slice(1);
        }
      });
    })();
  </script>
</body>
</html>
